---
title: "Rolling Stone's Top 500: A Shiny App"
author: "Emma N."
subtitle: "Data Science Final Presentation"
format:
  revealjs:
    scrollable: true
    slide-number: true
    show-slide-number: all
    preview-links: true
    embed-resources: true
    theme: moon
fontsize: "20pt"
execute:
  echo: true
  warning: false
  message: false
---

# The Data

## The Dataset

This data set from TidyTuesday originates from a [Google Sheet](https://docs.google.com/spreadsheets/d/1QguM-JM3LAJuZlnmY8aN0MutBJrZAzDs3aWZWTtF1WU/edit?gid=0#gid=0) compiled by Chris Eckert. It compares Rolling Stone’s “500 Greatest Albums of All Time” lists from 2003, 2012, and 2020 and includes information on each album's name, genre, release year, 2003/2012/2020 rank, the artist’s name, birth year, gender, and more. This analysis looks at the trend in the production of the "greatest" albums over time. Which years were the most fruitful? Are artists getting worse at producing incredible albums?

```{r}

library(tidyverse)

tuesdata <- tidytuesdayR::tt_load(2024, week = 19)

rolling_stone <- tuesdata$rolling_stone

colnames(rolling_stone)


```

\
Sources:

[Rolling Stone Album Rankings](https://github.com/rfordatascience/tidytuesday/blob/main/data/2024/2024-05-07/readme.md): Tidy Tuesday Data from 2024-05-07

Dalla Riva, C., & Daniels, M. (n.d.). *WHAT MAKES AN ALBUM THE GREATEST OF ALL TIME?* The Pudding. <https://pudding.cool/2024/03/greatest-music/>.

## Original Data Visualization

[View via Quarto Website](https://emma6547.github.io/dataviztwo.html)

# Implementing Shiny 

## The Code

```{r}

library(tidyverse)
library(shiny)
library(scales)
library(shinythemes)

tuesdata <- tidytuesdayR::tt_load(2024, week = 19)

rolling_stone <- tuesdata$rolling_stone

genre_list <- rolling_stone |> 
  filter(!is.na(genre)) |> 
  distinct(genre) |> 
  select(genre)

ui <- fluidPage(theme = shinytheme("superhero"),
  
  titlePanel("Rolling Stone Top 500 Albums by Genre"),
  
  sidebarLayout(
    sidebarPanel(
      selectInput("genre", "Genre", genre_list),
      sliderInput("range", "Release Year", value = c(1950, 2020), min = 1950, max = 2020)),
    mainPanel(
      plotOutput("myPlot"),
      textOutput("TotalNumber")
    )
  )
)

server <- function(input, output) {

  output$myPlot <- renderPlot({
    
    rolling_stone_df <- rolling_stone |>  
      filter(genre == input$genre) |> 
      group_by(release_year) |> 
      summarize(num_per_year = n_distinct(album))
    
    genre_number <- rolling_stone |> 
      filter(genre == input$genre) |> 
      summarise(n_distinct(album))
    
    ggplot(rolling_stone_df, 
           aes(x = release_year, y = num_per_year)) +
      geom_point(
        size = 2, 
        color = "steelblue3") +
      scale_x_continuous(
        limits = c(input$range)) +
      scale_y_continuous(
        limits = c(0, 10), 
        breaks = pretty_breaks()) +
      geom_smooth(
        method = "lm", 
        color = "royalblue4") +
      labs(
        title = "Rolling Stone's Greatest Albums of All Time",
        x = "Release Year",
        y = "Number of Albums Included in Top 500 Ranking",
        ) +
      annotate(
        "text",
        x = Inf, y = Inf,                      
        hjust = 1.1, vjust = 1.5,
        label = paste("Total albums:", genre_number),
        color = "royalblue4",
        size = 5,
        fontface = "bold"
      )
    })
  
  output$TotalNumber <- renderText({"
  Source: Dalla Riva, C., & Daniels, M. (n.d.). WHAT MAKES AN ALBUM THE GREATEST OF ALL TIME? 
    The Pudding. https://pudding.cool/2024/03/greatest-music/."
  })
}

shinyApp(ui = ui, server = server)
```

## The Outcome

[Shiny App](https://em4567.shinyapps.io/shiny_app/)

An interactive app gives the user the opportunity to engage with the data in a more tangible manner. Distinguishing between trends in Top 500 Album constituents by genre provides insight not just into the distribution of Rolling Stone's rankings over release year, but also reveals interesting trends about which genres have ebbed and flowed in popularity over time.
